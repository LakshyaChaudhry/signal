// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Day {
  id          String      @id @default(cuid())
  wakeTime    DateTime
  sleepTime   DateTime?   // null until day is closed
  signalTotal Int         @default(0)  // total minutes of high-signal work
  wastedTotal Int         @default(0)  // total minutes wasted
  entries     LogEntry[]
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  @@index([wakeTime])
}

model LogEntry {
  id        String   @id @default(cuid())
  dayId     String
  day       Day      @relation(fields: [dayId], references: [id], onDelete: Cascade)
  timestamp DateTime
  content   String   // raw text typed by user
  type      String   // "wake", "sleep", "signal", "wasted", "neutral"
  duration  Int?     // minutes (if applicable)
  quality   String?  // "deep", "focused", "neutral", "distracted", "wasted"
  isDraft   Boolean  @default(false) // true for auto-created timer entries
  createdAt DateTime @default(now())

  @@index([dayId])
  @@index([timestamp])
  @@index([isDraft])
}

